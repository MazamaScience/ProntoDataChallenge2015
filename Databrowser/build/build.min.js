// Main js file. JS code follows many of the guidelines specified at https://github.com/johnpapa/angular-styleguide
// Exposes the model to the template
// Contains plot options, map, and overlay options
// Creates a full page popup that fades out when clicked
// Relies on CSS rules from Mazama_databrowser_base.css
// There should be no need to make changes to this
// Relies on CSS rules from Mazama_databrowser_base.css
// There should be no need to make changes to this
// this data.
// Service for making JSON requests. Also provides access to the request status, i.e. 
// loading or error messages
(function(){"use strict";function e(e,t){e.state("index",{url:"/",templateUrl:"views/main.html"}).state("about",{url:"/about",templateUrl:"views/about.html"}),t.otherwise("/")}angular.module("App",["ui.router","ngMaps","ui.slider","ui.bootstrap"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider"]})(),function(){"use strict";function e(e,t,r,n){function a(){r.get(t.request).then(function(e){t.result=e})}var u=this;u.request=t.request,u.forms=t.forms,u.map=t.map(e),u.map.events=u.map.events,u.marker=t.marker,u.updatePlot=a,u.status=r.status,u.popup={visible:!1,url:null},a(),e.$watch(function(){return t.result},function(){t.result&&(u.url=t.result.data.rel_base+".png",u.popup.url=u.url)}),e.$watch(function(){return n.search()},function(e){for(var t in e)u.request.hasOwnProperty(t)&&(u.request[t]=e[t])},!0),e.$watch(function(){return u.request},function(e){var t=n.search();for(var r in e)t[r]=e[r];n.search(t)},!0)}angular.module("App").controller("Main",e),e.$inject=["$scope","LocalData","RequestService","$location"]}(),angular.module("App").directive("selectMenu",["$compile",function(e){return{restrict:"E",transclude:!0,scope:{model:"=",options:"="},template:'<div class="btn-group" dropdown><button type="button" class="btn btn-default btn-block" dropdown-toggle>{{getText(model)}} <span class="caret"></span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="opt in options" ng-click="click(opt)"><a>{{opt.text}}</a></li></ul></div>',link:function(t,r){var n=t.options;t.getText=function(e){for(var t=0;n.length>t;t++)if(n[t].value===e)return n[t].text;return""},t.click=function(e){t.model=e.value},e(r.html())(t)}}}]),angular.module("App").directive("popup",function(){return{restrict:"E",transclude:!0,scope:{visible:"="},template:'<div class="popup-wrapper" ng-click="visible=false" ng-class="{visible: visible}"><div class="row popup" ng-transclude></div></div>'}}),function(){"use strict";function e(){var e={language:"en",plotWidth:700,plotType:"growth",userType:"Annual Member",weekday_weekend:"weekday",lat:47,lng:-122},t={userType:[{text:"Annual Member",value:"Annual Member"},{text:"Short-Term Pass Holder",value:"Short-Term Pass Holder"}],weekday_weekend:[{text:"Weekday",value:"Weekday"},{text:"Weekend",value:"Weekend"}]},r=function(e){return{center:[47,-122],zoom:4,events:{click:function(t){a.request.lat=Math.round(Math.pow(10,4)*t.latLng.lat())/Math.pow(10,4),a.request.lng=Math.round(Math.pow(10,4)*t.latLng.lng())/Math.pow(10,4),e.$apply()}}}},n={options:function(){return{draggable:!0}},decimals:4},a={request:e,forms:t,map:r,marker:n};return a}angular.module("App").factory("LocalData",e),e.$inject=[]}(),function(){"use strict";function e(e,t){function r(){return i}function n(e){var t="";for(var r in e)""!==t&&(t+="&"),t+=r+"="+e[r];return t}function a(e){return t.reject(e.data.message)}function u(e){return i.loading=!1,"ERROR"===e.data.status?(i.error=e.data.error_text,t.reject(e.data.error_text)):e}function o(t){i.loading=!0,i.error=!1;var r=e({method:"POST",url:l+n(t)});return r.then(u,a)}var l="/cgi-bin/__DATABROWSER__.cgi?",i={loading:!1,error:!1},s={status:r,get:o};return s}angular.module("App").factory("RequestService",e),e.$inject=["$http","$q"]}();