// Main js file. JS code follows many of the guidelines specified at https://github.com/johnpapa/angular-styleguide
// Exposes the model to the template
// Contains plot options, map, and overlay options
// Creates a full page popup that fades out when clicked
// Relies on CSS rules from Mazama_databrowser_base.css
// There should be no need to make changes to this
// Relies on CSS rules from Mazama_databrowser_base.css
// There should be no need to make changes to this
// this data.
// Service for making JSON requests. Also provides access to the request status, i.e. 
// loading or error messages
(function(){"use strict";function t(t,e){t.state("index",{url:"/",templateUrl:"views/main.html"}).state("about",{url:"/about",templateUrl:"views/about.html"}),e.otherwise("/")}angular.module("App",["ui.router","ngMaps","ui.slider","ui.bootstrap"]).config(t),t.$inject=["$stateProvider","$urlRouterProvider"]})(),function(){"use strict";function t(t,e,a,r){function n(){a.get(e.request).then(function(t){e.result=t})}var u=this;u.request=e.request,u.forms=e.forms,u.map=e.map(t),u.map.events=u.map.events,u.marker=e.marker,u.updatePlot=n,u.status=a.status,u.popup={visible:!1,url:null},n(),t.$watch(function(){return e.result},function(){e.result&&(u.url=e.result.data.rel_base+".png",u.popup.url=u.url)}),t.$watch(function(){return r.search()},function(t){for(var e in t)u.request.hasOwnProperty(e)&&(u.request[e]=t[e])},!0),t.$watch(function(){return u.request},function(t){var e=r.search();for(var a in t)e[a]=t[a];r.search(e)},!0)}angular.module("App").controller("Main",t),t.$inject=["$scope","LocalData","RequestService","$location"]}(),angular.module("App").directive("selectMenu",["$compile",function(t){return{restrict:"E",transclude:!0,scope:{model:"=",options:"="},template:'<div class="btn-group" dropdown><button type="button" class="btn btn-default btn-block" dropdown-toggle>{{getText(model)}} <span class="caret"></span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="opt in options" ng-click="click(opt)"><a>{{opt.text}}</a></li></ul></div>',link:function(e,a){var r=e.options;e.getText=function(t){for(var e=0;r.length>e;e++)if(r[e].value===t)return r[e].text;return""},e.click=function(t){e.model=t.value},t(a.html())(e)}}}]),angular.module("App").directive("popup",function(){return{restrict:"E",transclude:!0,scope:{visible:"="},template:'<div class="popup-wrapper" ng-click="visible=false" ng-class="{visible: visible}"><div class="row popup" ng-transclude></div></div>'}}),function(){"use strict";function t(){var t={language:"en",plotWidth:640,plotType:"growth",productType:"systemTable",userType:"all",dayType:"all",timeOfDay:"all",distance:"all",lat:47,lng:-122},e={plotType:[{text:"growth",value:"growth"},{text:"heatmap",value:"heatmap"},{text:"stationBubble",value:"stationBubble"}],userType:[{text:"All",value:"all"},{text:"Annual",value:"annual"},{text:"Short-Term",value:"shortTerm"}],dayType:[{text:"All",value:"all"},{text:"Weekday",value:"weekday"},{text:"Weekend",value:"weekend"}],timeOfDay:[{text:"All",value:"all"},{text:"AM Commute",value:"amCommute"},{text:"Mid Day",value:"midday"},{text:"PM Commute",value:"pmCommute"},{text:"Evening",value:"evening"},{text:"Night",value:"night"}],distance:[{text:"All",value:"all"},{text:"Zero",value:"zero"},{text:"0-1 km",value:"0_1"},{text:"1-2 km",value:"1_2"},{text:"2-3 km",value:"23"},{text:"3-5 km",value:"3_5"},{text:" >5 km",value:"5_"}]},a=function(t){return{center:[47,-122],zoom:4,events:{click:function(e){n.request.lat=Math.round(Math.pow(10,4)*e.latLng.lat())/Math.pow(10,4),n.request.lng=Math.round(Math.pow(10,4)*e.latLng.lng())/Math.pow(10,4),t.$apply()}}}},r={options:function(){return{draggable:!0}},decimals:4},n={request:t,forms:e,map:a,marker:r};return n}angular.module("App").factory("LocalData",t),t.$inject=[]}(),function(){"use strict";function t(t,e){function a(){return i}function r(t){var e="";for(var a in t)""!==e&&(e+="&"),e+=a+"="+t[a];return e}function n(t){return e.reject(t.data.message)}function u(t){return i.loading=!1,"ERROR"===t.data.status?(i.error=t.data.error_text,e.reject(t.data.error_text)):t}function l(e){i.loading=!0,i.error=!1;var a=t({method:"POST",url:o+r(e)});return a.then(u,n)}var o="/cgi-bin/__DATABROWSER__.cgi?",i={loading:!1,error:!1},s={status:a,get:l};return s}angular.module("App").factory("RequestService",t),t.$inject=["$http","$q"]}();