// Main js file. JS code follows many of the guidelines specified at https://github.com/johnpapa/angular-styleguide
// Exposes the model to the template
// Contains plot options, map, and overlay options
// Creates a full page popup that fades out when clicked
// Relies on CSS rules from Mazama_databrowser_base.css
// There should be no need to make changes to this
// Relies on CSS rules from Mazama_databrowser_base.css
// There should be no need to make changes to this
// this data.
// Service for making JSON requests. Also provides access to the request status, i.e. 
// loading or error messages
(function(){"use strict";function e(e,t){e.state("index",{url:"/",templateUrl:"views/main.html"}).state("about",{url:"/about",templateUrl:"views/about.html"}),t.otherwise("/")}angular.module("App",["ui.router","ngMaps","ui.slider","ui.bootstrap"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider"]})(),function(){"use strict";function e(e,t,a,n){function l(){a.get(t.request).then(function(e){t.result=e})}var r=this;r.request=t.request,r.forms=t.forms,r.map=t.map(e),r.map.events=r.map.events,r.marker=t.marker,r.updatePlot=l,r.status=a.status,r.popup={visible:!1,url:null},l(),e.$watch(function(){return t.result},function(){t.result&&(r.url=t.result.data.rel_base+".png",r.popup.url=r.url)}),e.$watch(function(){return n.search()},function(e){for(var t in e)r.request.hasOwnProperty(t)&&(r.request[t]=e[t])},!0),e.$watch(function(){return r.request},function(e){var t=n.search();for(var a in e)t[a]=e[a];n.search(t)},!0)}angular.module("App").controller("Main",e),e.$inject=["$scope","LocalData","RequestService","$location"]}(),angular.module("App").directive("selectMenu",["$compile",function(e){return{restrict:"E",transclude:!0,scope:{model:"=",options:"="},template:'<div class="btn-group" dropdown><button type="button" class="btn btn-default btn-block" dropdown-toggle>{{getText(model)}} <span class="caret"></span></button><ul class="dropdown-menu" role="menu"><li ng-repeat="opt in options" ng-click="click(opt)"><a>{{opt.text}}</a></li></ul></div>',link:function(t,a){var n=t.options;t.getText=function(e){for(var t=0;n.length>t;t++)if(n[t].value===e)return n[t].text;return""},t.click=function(e){t.model=e.value},e(a.html())(t)}}}]),angular.module("App").directive("popup",function(){return{restrict:"E",transclude:!0,scope:{visible:"="},template:'<div class="popup-wrapper" ng-click="visible=false" ng-class="{visible: visible}"><div class="row popup" ng-transclude></div></div>'}}),function(){"use strict";function e(){var e={language:"en",plotWidth:640,plotType:"weeklyUsageByDayOfWeek",productType:"systemTable",userType:"all",dayType:"all",timeOfDay:"all",distance:"all",lat:47,lng:-122},t={plotType:[{text:"Weekly by DoW",value:"weeklyUsageByDayOfWeek"},{text:"Dailiy by Hour",value:"dailyUsageByHourOfDay"},{text:"Weather Calendar",value:"calendarHeatmap"},{text:"stationBubble",value:"stationBubble"}],userType:[{text:"All",value:"all"},{text:"Short-Term",value:"shortTerm"},{text:"Annual",value:"annual"},{text:"Annual (male)",value:"annualMale"},{text:"Annual (female)",value:"annualFemale"},{text:"Annual (other)",value:"annualOther"}],dayType:[{text:"All",value:"all"},{text:"Weekday",value:"weekday"},{text:"Weekend",value:"weekend"}],timeOfDay:[{text:"All",value:"all"},{text:"Early 4-6",value:"early"},{text:"AM Commute 7-9",value:"amCommute"},{text:"Mid Day 10-3",value:"midday"},{text:"PM Commute 4-6",value:"pmCommute"},{text:"Evening 7-10",value:"evening"},{text:"Night 11-3",value:"night"}],distance:[{text:"All",value:"all"},{text:"Zero",value:"zero"},{text:"0-1 km",value:"0_1"},{text:"1-2 km",value:"1_2"},{text:"2-3 km",value:"2_3"},{text:"3-5 km",value:"3_5"},{text:" >5 km",value:"5_"}]},a=function(e){return{center:[47,-122],zoom:4,events:{click:function(t){l.request.lat=Math.round(Math.pow(10,4)*t.latLng.lat())/Math.pow(10,4),l.request.lng=Math.round(Math.pow(10,4)*t.latLng.lng())/Math.pow(10,4),e.$apply()}}}},n={options:function(){return{draggable:!0}},decimals:4},l={request:e,forms:t,map:a,marker:n};return l}angular.module("App").factory("LocalData",e),e.$inject=[]}(),function(){"use strict";function e(e,t){function a(){return i}function n(e){var t="";for(var a in e)""!==t&&(t+="&"),t+=a+"="+e[a];return t}function l(e){return t.reject(e.data.message)}function r(e){return i.loading=!1,"ERROR"===e.data.status?(i.error=e.data.error_text,t.reject(e.data.error_text)):e}function u(t){i.loading=!0,i.error=!1;var a=e({method:"POST",url:o+n(t)});return a.then(r,l)}var o="/cgi-bin/__DATABROWSER__.cgi?",i={loading:!1,error:!1},s={status:a,get:u};return s}angular.module("App").factory("RequestService",e),e.$inject=["$http","$q"]}();